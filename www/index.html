<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Pi Robot</title>

    <link href="/css/bootstrap.css" rel="stylesheet">

    <style>
      .thin.container {
        max-width:700px;
      }
    </style>
    
    <style type="text/css">
        .joystick {
            position: relative;
            width: 130px;
            height: 130px;
            background-color: #eee;
        }
        .joystick .handle {
            position: absolute;
            width: 24px;
            height: 24px;
            background-color: rgb(201, 44, 44);
            border: 1px solid rgb(107, 35, 35);
            border-radius: 5px;
        }
    </style>
    
    <script src="js/jquery.js"></script>
    <script src="js/jquery.form.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery.joystick.js"></script>
    <script src="js/sockjs-0.3.min.js"></script>
    
    <script>
        $(document).ready(function() { 
        
            socket = new SockJS("http://" + window.location.hostname + ":8081/robot_control");
        
            $("#camera").attr( "src", "http://" + window.location.hostname + ":8080/?action=stream" );
  
            $('#motor_stick').joystick({
                xSnap: true,
                ySnap: true,
                moveEvent: function(pos) { socket.send( "Move " + 2.0*(pos.x - 0.5) + " " + 2.0*(pos.y - 0.5) ) },
                endEvent: function(pos) { socket.send( "Move " + 2.0*(pos.x - 0.5) + " " + 2.0*(pos.y - 0.5) ) }
            });
            $('#pan_tilt_stick').joystick({
                xSnap: true,
                ySnap: true,
                moveEvent: function(pos) { socket.send( "PanTilt " + 2.0*(pos.x - 0.5) + " " + 2.0*(pos.y - 0.5) ) },
                endEvent: function(pos) { socket.send( "PanTilt " + 2.0*(pos.x - 0.5) + " " + 2.0*(pos.y - 0.5) ) }
            });
            
            $('#motor_stick').joystick('value', 0.5, 0.5);
            $('#pan_tilt_stick').joystick('value', 0.5, 0.5);
        }); 
    </script>

  </head>

  <body>
    <div class="container thin">
      <div class="page-header">
      <h1>Pi Robot</h1>
    </div>

    <div class="container thin">
      <p><img id="camera" src=""/></p>
    
      <div class="joystick" id="motor_stick">
        <div class="handle"></div>
      </div>
    
      <div class="joystick" id="pan_tilt_stick">
        <div class="handle"></div>
      </div>
    
    </div>
    
  </body>
</html>
